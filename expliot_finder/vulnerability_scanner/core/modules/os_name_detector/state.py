"""Dataclasses where 'os_name_detector' module will store the detected
information temporarily before being saved into global dataclass named:
'CapturedSensitiveInfo'.
"""

__all__ = ("DetectedOSName",)

from dataclasses import dataclass
from typing import Dict, Optional


@dataclass(kw_only=True, slots=True)
class DetectedOSName:
    """Store detected OS name of the chosen target.

    Attributes:
        name:
            The detected OS name of the chosen target.
    """

    name: Optional[str] = "Unknown"

    def __iter__(self) -> Dict[str, str]:
        """Allow transforming dataclass into dict."""
        if self.name:
            yield "os_name", self.name
