#!/usr/bin/env python3
"""Find vulnerabilities, CVEs and ready exploits for chosen target.

Usage:
    find_exploits.py     <target_ip>
    find_exploits.py     <target_ip> [-p <port_amount>]
    find_exploits.py     (-h | --help)
    find_exploits.py     --version

Options:
    -h --help     Show this screen.
    --version     Show version.
    -p            Provide a number of ports to scan for which exploits will be searched for.

Arguments:
    target_ip           Provides the IP of the target for which you want to find
                        exploits. Only one single device can be selected per
                        each run.

    port_amount         Specify port amount. This ports starting from 1 to
                        'port_amount' value will be scanned in 'target'.
"""
from docopt import docopt
from pyfiglet import figlet_format

from expliot_finder import ExploitFinderExecutor, __version__

# TODO add scan of top 20 ports
if __name__ == "__main__":
    print(figlet_format("EXPLIOT FINDER"))

    cli_kwargs = docopt(__doc__, version="VERSION: " + ".".join(__version__))

    main_executor = ExploitFinderExecutor()
    main_executor.filtered_kw = cli_kwargs
    main_executor()
